<div class="flex-grow">
  <div class="bg-gray-100">
    <div class="container w-full mx-auto px-4">
      <div class="p-6">
        <form action="/" method="GET">
          <div class="relative bg-white rounded-full border-1 border-gray-300">
            
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                  viewBox="0 0 24 24" fill="none" stroke="currentColor"
                  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="lucide lucide-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.3-4.3"></path>
            </svg>
        
            
            <input name="search" 
                    class="flex h-10 w-full bg-background px-3 ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 pl-10 pr-20 py-6 rounded-full border-gray-200 focus-visible:ring-yellow-500 focus-visible:border-yellow-300 text-lg"
                    placeholder="Search..." type="text" value="<%= filterBy.search || ''%>">
        
            <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-2">
              
              <input name="zipcode" type="text" placeholder="Zipcode" value="<%= filterBy.zipcode || ''%>" class="pr-6 rounded-full text-sm w-22 border border-gray-300 rounded px-2 py-1 focus:ring-yellow-500 focus:border-yellow-400" />
        
              
              <button type="submit"
                      class="text-white inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 text-primary-foreground h-10 py-2 rounded-full bg-yellow-500 hover:bg-yellow-600 px-4">
                Search
              </button>
            </div>
          </div>
        </form>
        
        <div class="mt-4">
          <div class="flex flex-wrap gap-2">
            <span class="text-sm text-gray-500 font-bold">Popular:</span>
            <% const activeCategory = filterBy?.category || ''; %>

            <a href="/?category=Restaurants">
              <button class="<%= activeCategory === 'Restaurants' ? 'text-[#4793EB]' : 'text-gray-700' %> cursor-pointer text-sm hover:text-[#4793EB] transition-colors flex items-center gap-1">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-coffee h-4 w-4">
                  <path d="M10 2v2"></path>
                  <path d="M14 2v2"></path>
                  <path d="M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1"></path>
                  <path d="M6 2v2"></path>
                </svg>
                <span>Restaurants</span>
              </button>
            </a>
        
            <a href="/?category=Technology">
              <button class="<%= activeCategory === 'Technology' ? 'text-[#4793EB]' : 'text-gray-700' %> cursor-pointer text-sm hover:text-[#4793EB] transition-colors flex items-center gap-1">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="cursor-pointer lucide lucide-laptop h-4 w-4">
                  <path d="M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16"></path>
                </svg>
                <span>Technology</span>
              </button>
            </a>
        
            <a href="/?category=Healthcare">
              <button class="<%= activeCategory === 'Healthcare' ? 'text-[#4793EB]' : 'text-gray-700' %> cursor-pointer text-sm  hover:text-[#4793EB] transition-colors flex items-center gap-1">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="cursor-pointer lucide lucide-stethoscope h-4 w-4">
                  <path d="M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3"></path>
                  <path d="M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4"></path>
                  <circle cx="20" cy="10" r="2"></circle>
                </svg>
                <span>Healthcare</span>
              </button>
            </a>
        
            <a href="/?category=Fitness">
              <button class="<%= activeCategory === 'Fitness' ? 'text-[#4793EB]' : 'text-gray-700' %> cursor-pointer text-sm  hover:text-[#4793EB] transition-colors flex items-center gap-1">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-dumbbell h-4 w-4">
                  <path d="M14.4 14.4 9.6 9.6"></path>
                  <path d="M18.657 21.485a2 2 0 1 1-2.829-2.828l-1.767 1.768a2 2 0 1 1-2.829-2.829l6.364-6.364a2 2 0 1 1 2.829 2.829l-1.768 1.767a2 2 0 1 1 2.828 2.829z"></path>
                  <path d="m21.5 21.5-1.4-1.4"></path>
                  <path d="M3.9 3.9 2.5 2.5"></path>
                  <path d="M6.404 12.768a2 2 0 1 1-2.829-2.829l1.768-1.767a2 2 0 1 1-2.828-2.829l2.828-2.828a2 2 0 1 1 2.829 2.828l1.767-1.768a2 2 0 1 1 2.829 2.829z"></path>
                </svg>
                <span>Fitness</span>
              </button>
            </a>
        
            <a href="/?category=Professional%20Services">
              <button class="<%= activeCategory === 'Professional%20Services' ? 'text-[#4793EB]' : 'text-gray-700' %> cursor-pointer text-sm  hover:text-[#4793EB] transition-colors flex items-center gap-1">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-briefcase h-4 w-4">
                  <path d="M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
                  <rect width="20" height="14" x="2" y="6" rx="2"></rect>
                </svg>
                <span>Professional Services</span>
              </button>
            </a>
          </div>
        </div>

      </div>
    </div>
  </div>
  <div class="container w-full mx-auto px-4">
    <div class="transition-all duration-300 mx-auto">
      <div class="flex-grow">
          <div class="container mx-auto px-4 py-8">
            <div class="transition-all duration-300 grid grid-cols-1 lg:grid-cols-[1fr_400px] gap-8">
              
              <div class="space-y-6">
                <div class="flex items-center justify-between">
                  <p class="text-muted-foreground text-gray-500"><%= results.length %> business found</p>
                  
                </div>
                <div class="overflow-y-scroll max-h-[80vh] pr-5">

                  <% if (results.length > 0) { %>
                    <% results.forEach(business => { %>
                      <%- include('mainSearchResult', { business: business }) %>
                    <% }); %>
                  <% } else { %>
                    <div class="bg-white border border-gray-200 rounded-xl p-6 mt-8 shadow-sm text-gray-700 max-w-2xl mx-auto">
                      <h2 class="text-xl font-semibold text-gray-800 mb-2">No results found</h2>
                      <p class="mb-1">No results containing all your search terms were found.</p>
                      <p class="mb-4">Your search did not match any documents.</p>
                      <p class="font-medium">Suggestions:</p>
                      <ul class="list-disc list-inside space-y-1 mt-1">
                        <li>Make sure all words are spelled correctly.</li>
                        <li>Try different keywords.</li>
                        <li>Try more general keywords.</li>
                      </ul>
                    </div>  
                  <% } %>
                </div>
              </div>

              <!-- chatbot space -->
              
              
                
              <div class="bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200 h-[590px]">
                <div class="flex border-b border-gray-200">
                  <div class="flex-1 py-3 px-4 flex items-center justify-center gap-2 font-medium text-sm text-yellow-600 border-b-2 border-yellow-500">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bot h-4 w-4">
                      <path d="M12 8V4H8"></path>
                      <rect width="16" height="12" x="4" y="8" rx="2"></rect>
                      <path d="M2 14h2"></path>
                      <path d="M20 14h2"></path>
                      <path d="M15 13v2"></path>
                      <path d="M9 13v2"></path>
                    </svg>
                    <span>Chat with Assistant</span>
                  </div>
                </div>
                <div class="flex flex-col h-[535px]">
                  <div dir="ltr" class="relative overflow-hidden flex-grow p-4" style="position: relative; --radix-scroll-area-corner-width: 0px; --radix-scroll-area-corner-height: 0px;">
                    <div data-radix-scroll-area-viewport="" class="h-full w-full rounded-[inherit]" style="overflow: hidden scroll;">
                      <div style="min-width: 100%; display: table;">
                        <div id="chatMessages" class="space-y-4 overflow-y-auto h-[400px]">

                          <!-- chat space -->
                          
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="p-4 border-t border-gray-200 mt-auto">
                    <div class="flex gap-2 items-center">
                      
                      <form id="chatForm" class="flex flex-1 gap-2 items-center">
                        <div class="relative flex-1">
                          <textarea
                            id="chatInput"
                            name="chat"
                            class="flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:border-yellow-300 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 min-h-[40px] pr-10 resize-none"
                            placeholder="Ask about businesses, services, or recommendations..."
                            required
                          ></textarea>
                        </div>
                  
                        <button
                          type="submit"
                          class="cursor-pointer inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 text-primary-foreground h-10 w-10 bg-yellow-500 hover:bg-yellow-600 rounded-full text-white"
                        >
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="lucide lucide-send h-4 w-4">
                          <path d="m22 2-7 20-4-9-9-4Z"></path>
                          <path d="M22 2 11 13"></path>
                        </svg>
                        </button>
                      </form>
                  
                      
                      <button
                        id="callGeneralAI"
                        class="text-gray-500 cursor-pointer border-gray-500 inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 w-10 rounded-full"
                      >
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bot h-4 w-4">
                        <path d="M12 8V4H8"></path>
                        <rect width="16" height="12" x="4" y="8" rx="2"></rect>
                        <path d="M2 14h2"></path>
                        <path d="M20 14h2"></path>
                        <path d="M15 13v2"></path>
                        <path d="M9 13v2"></path>
                      </svg>
                      </button>
                  
                    </div>
                  </div>
                  
                </div>
              </div>
            </div>



            </div>
          </div>
        </div>
    </div>
  </div>
</div>

